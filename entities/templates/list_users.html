{% extends 'base.html' %}
{% block content %}
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2>Entity Users - {{ entity_name }} (Total: {{ total }})</h2>
    <a href="{{ url_for('create_user') }}" class="btn btn-primary">+ Add User</a>
  </div>
  
  {% if user_grants and user_grants|length > 0 %}
    <table border="1" cellpadding="8" cellspacing="0" style="width: 100%; border-collapse: collapse;">
      <thead style="background-color: #f5f5f5;">
        <tr>
          <th>Email</th>
          <th>Permissions</th>
          <th>User ID</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for grant in user_grants %}
          <tr>
            <td>{{ grant.userEmail or 'N/A' }}</td>
            <td>
              {% if grant.permissions %}
                <span class="permissions-list">{{ grant.permissions|join(', ') }}</span>
              {% else %}
                <em>No permissions</em>
              {% endif %}
            </td>
            <td><code>{{ grant.userId or 'N/A' }}</code></td>
            <td>
              <div class="action-buttons">
                <a href="{{ url_for('edit_user_permissions', user_id=grant.userId) }}" 
                   class="btn btn-edit" title="Edit Permissions">Edit</a>
                <form method="POST" action="{{ url_for('delete_user', user_id=grant.userId) }}" 
                      style="display: inline;" 
                      onsubmit="return confirm('Are you sure you want to delete this user? This action cannot be undone.');">
                  <button type="submit" class="btn btn-delete" title="Delete User">Delete</button>
                </form>
              </div>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div style="text-align: center; padding: 40px; background-color: #f9f9f9; border-radius: 8px;">
      <p style="margin-bottom: 16px; color: #666;">No users found for this entity.</p>
      <a href="{{ url_for('create_user') }}" class="btn btn-primary">+ Add First User</a>
    </div>
  {% endif %}
  
  <div style="margin-top: 20px;">
    <a href="{{ url_for('profile') }}">‚Üê Back to Profile</a>
  </div>

  <style>
    .btn {
      display: inline-block;
      padding: 6px 12px;
      margin: 2px;
      text-decoration: none;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
    }
    
    .btn-primary {
      background-color: #007bff;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #0056b3;
    }
    
    .btn-edit {
      background-color: #28a745;
      color: white;
    }
    
    .btn-edit:hover {
      background-color: #1e7e34;
    }
    
    .btn-delete {
      background-color: #dc3545;
      color: white;
    }
    
    .btn-delete:hover {
      background-color: #c82333;
    }
    
    .action-buttons {
      white-space: nowrap;
    }
    
    .permissions-list {
      background-color: #e9ecef;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
      font-size: 12px;
    }
    
    table th, table td {
      text-align: left;
      vertical-align: top;
    }
    
    table th {
      background-color: #f8f9fa;
      font-weight: 600;
    }
  </style>
{% endblock %}


